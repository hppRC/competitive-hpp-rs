[tasks.PUBLISH]
description = "Publish package"
script = [
    '''
#!/usr/bin/env fish
printf "\e[33m✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨\e[m"
echo Publish this package to crate.io
printf "\e[33m✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨\e[m"
cargo publish
''']
dependencies = ["bump", "git"]


[tasks.bump]
description = "Bump package version"
script = ['''
#!/usr/bin/env fish
echo Updating package version...

cargo bump $argv
printf "\e[33m✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨\e[m"
echo New package version: (cargo metadata --format-version=1 --no-deps | jq .packages[0].version | sed s/\"//g)
printf "\e[33m✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨\e[m"
'''
]

[tasks.git]
description = "Commit and make tag"
script = ['''
#!/usr/bin/env fish
printf "\e[33m✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨\e[m"
git add Cargo.toml
git commit -m ":tada: Update package version"
git tag v(cargo metadata --format-version=1 --no-deps | jq .packages[0].version | sed s/\"//g)
git push origin v(cargo metadata --format-version=1 --no-deps | jq .packages[0].version | sed s/\"//g)
git push origin master
printf "\e[33m✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨✨\e[m"
'''
]
dependencies = ["bump"]
